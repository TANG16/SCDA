sey <- beta*exp(bs/2) # st.dev. of y in each midpoint
Gamma <- matrix(0,m,m)
for (i in 1:m) Gamma[i,] <- diff(pnorm(b,phi*bs[i],sigma)) #time constant tpm
Gamma
phi
bs
sey
b
bs
sey
i=1
diff(pnorm(b,phi*bs[i],sigma))
diff(pnorm((b-phi*bs[i])/sigma))
bs
phi
diff(pnorm((b-phi*bs[i])/sigma))
Gamma[,1]
Gamma[1,]
t=1
dnorm(y[t],0,sey)
y[1]
dnorm(0.0505,0,sey)
dnorm(   0.050515497452117,0,sey)
Gamma*dnorm(y[t],0,sey)
P <- dnorm(y[t],0,sey)
Gamma*P
dim(Gamma*P)
dim(P)
dim(Gamma)
A=matrix(c(1:9),ncol = 3,nrow=3,byrow = TRUE)
A
B=c(10:10:90)
B
B=seq(10,90,by=10)
B
B=seq(10,300,by=10)
B=seq(10,30,by=10)
m <- 30 #50 100 200
gmax <- 4
phi <- 0.98
sigma <- 0.2
beta <- 0.05
P1 <- (sigma^2)/(1-phi^2)
T <- 1000
h <- rep(NaN,1000)
h[1] <- sqrt(P1)*rnorm(1)
for (t in c(2:T)){
h[t] = phi*h[t-1] + sigma*rnorm(1)
}
y <- beta*exp(h/2)*rnorm(T)
plot(y,type='l')
K <- m+1
b <- seq(- gmax,gmax,length=K) #endpoints
bs <- (b[-1]+b[-K])*0.5 # midpoints
sey <- beta*exp(bs/2) # st.dev. of y in each midpoint
Gamma <- matrix(0,m,m)
for (i in 1:m) Gamma[i,] <- diff(pnorm(b,phi*bs[i],sigma)) #time constant tpm
Gamma <- Gamma/apply(Gamma,1,sum)	 #scale the rows of Gamma to sum up to 1
foo <- solve(t(diag(m)-Gamma+1),rep(1,m)) # compute delta=delta*Gamma, the stationary distribution of the MC
llk <- 0
t=1
P <- dnorm(y[t],0,sey)
P
typeof(P)
typeof(Gamma)
typeof(foo)
foo%*%Gamma*dnorm(y[t],0,sey)
foo
Gamma*dnorm(y[t],0,sey)
size(Gamma*dnorm(y[t],0,sey))
dim(Gamma*dnorm(y[t],0,sey))
A<-matrix(c(1:9),nrow = 3,byrow = TRUE)
B<-c(10,20,30)
A*B
A%*%B
A*t(B)
t(B)*A
B*A
A
B
B<-matrix(c(10,20,30),nrow=3)
A*B
A*t(B)
A*as.vector(B)
B
A*B
A%*%B
Gamma%*%dnorm(y[t],0,sey)
Gamma%*%diag(dnorm(y[t],0,sey))
diag(dnorm(y[t],0,sey))
Gamma%*%diag(dnorm(y[t],0,sey))
Gamma%*%dnorm(y[t],0,sey)
Gamma%*%dnorm(y[t],0,sey)
Gamma*dnorm(y[t],0,sey)
phi
y[1]
foo%*%Gamma*dnorm(y[t],0,sey)
sumfoo
foo
foo <- solve(t(diag(m)-Gamma+1),rep(1,m)) # compute delta=delta*Gamma, the stationary distribution of the MC
t=1
llk <- 0
foo <- foo%*%Gamma*dnorm(y[t],0,sey)
sumfoo <- sum(foo)
sumfoo
foo
plot(foo,type='l')
plot(t(foo),type='l')
plot(t(foo))
llk <- llk+log(sumfoo)
foo <- foo/sumfoo
for (t in 2:length(y)){
# P <- dnorm(y[t],0,sey)
foo <- foo%*%Gamma*dnorm(y[t],0,sey)
sumfoo <- sum(foo)
llk <- llk+log(sumfoo)
foo <- foo/sumfoo
}
llk
foo <- solve(t(diag(m)-Gamma+1),rep(1,m)) # compute delta=delta*Gamma, the stationary distribution of the MC
llk <- 0
for (t in 1:length(y)){
# P <- dnorm(y[t],0,sey)
foo <- foo%*%Gamma*dnorm(y[t],0,sey)
sumfoo <- sum(foo)
llk <- llk+log(sumfoo)
# foo <- foo/sumfoo
}
llk
foo <- solve(t(diag(m)-Gamma+1),rep(1,m)) # compute delta=delta*Gamma, the stationary distribution of the MC
llk <- 0
for (t in 1:10){
# P <- dnorm(y[t],0,sey)
foo <- foo%*%Gamma*dnorm(y[t],0,sey)
sumfoo <- sum(foo)
llk <- llk+log(sumfoo)
# foo <- foo/sumfoo
}
llk
foo <- solve(t(diag(m)-Gamma+1),rep(1,m)) # compute delta=delta*Gamma, the stationary distribution of the MC
llk <- 0
for (t in 1:10){
# P <- dnorm(y[t],0,sey)
foo <- foo%*%Gamma*dnorm(y[t],0,sey)
sumfoo <- sum(foo)
llk <- llk+log(sumfoo)
foo <- foo/sumfoo
}
llk
log(sumfoo)
N_bin = 10 # Number of intervals
# Lower bin values:
qu <- c(0:(N_bin-1))/N_bin
mid <- qu+qu[2]/2
qu
mid
qu[2]
? qnorm
? qpois
source('C:/Users/aba228/Dropbox/Research Visit/Ruth King/Codes/BKM/Update/BKM_Run_HMM_approx_linux_unifprior_norm.R', echo=TRUE)
install.packages(rjags)
library("rjags", lib.loc="Q:/NRJ4BFCY/R-3.1.2/library")
library("rjags", lib.loc="Q:/NRJ4BFCY/R-3.1.2/library")
detach("package:rjags", unload=TRUE)
library("rjags", lib.loc="Q:/NRJ4BFCY/R-3.1.2/library")
load("C:/Users/aba228/Dropbox/Research Visit/Ruth King/Codes/BKM/Update/BKM_ESS.RData")
unlist(TTT)
load("C:/Users/aba228/Dropbox/Research Visit/Ruth King/Codes/Heron/Adaptive/Heron_HMM_approx_iter30000_ada1000_linux_COMB_unifprior_norm.RData")
mat1_HMM_10_5 = as.matrix(output_10_5[1])
mat2_HMM_10_5 = as.matrix(output_10_5[2])
mat_names_HMM_adapt <- colnames(mat1_HMM_10_5)
mat1_HMM_50_40 = as.matrix(output_50_40[1])
mat2_HMM_50_40 = as.matrix(output_50_40[2])
mat1_HMM_100_70 = as.matrix(output_100_70[1])
mat2_HMM_100_70 = as.matrix(output_100_70[2])
mat_names_HMM_adapt
par(mfrow=c(2,1),oma=c(0,0,1.5,0))
plot(colMeans(mat1_HMM_10_5[,(1:72)]), type='l', xlab ="", ylab="", sub="X2")
lines(colMeans(mat1_HMM_50_40[,(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,(1:72)]), type='l', col="red")
plot(colMeans(mat1_HMM_10_5[,72+(1:72)]), type='l', xlab ="", ylab="", sub="X4")
lines(colMeans(mat1_HMM_50_40[,72+(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,72+(1:72)]), type='l', col="red")
mtext("Posterior means", outer=TRUE, cex=1)
legend(60,6000,c("10,5)","50,40","100,70"), col=("black","blue","red"))
legend(60,6000,c("10,5","50,40","100,70"), col=("black","blue","red"))
par(mfrow=c(2,1),oma=c(0,0,1.5,0))
plot(colMeans(mat1_HMM_10_5[,(1:72)]), type='l', xlab ="", ylab="", sub="X2")
lines(colMeans(mat1_HMM_50_40[,(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,(1:72)]), type='l', col="red")
plot(colMeans(mat1_HMM_10_5[,72+(1:72)]), type='l', xlab ="", ylab="", sub="X4")
lines(colMeans(mat1_HMM_50_40[,72+(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,72+(1:72)]), type='l', col="red")
mtext("Posterior means", outer=TRUE, cex=1)
legend(60,6000,c("10,5","50,40","100,70"), col=("black","blue","red"))
legend(60,6000,c("10,5","50,40","100,70"), col=("green","blue","red"))
legend(60,6000,c("10,5","50,40","100,70"))
par(mfrow=c(2,1),oma=c(0,0,1.5,0))
plot(colMeans(mat1_HMM_10_5[,(1:72)]), type='l', xlab ="", ylab="", sub="X2")
lines(colMeans(mat1_HMM_50_40[,(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,(1:72)]), type='l', col="red")
plot(colMeans(mat1_HMM_10_5[,72+(1:72)]), type='l', xlab ="", ylab="", sub="X4")
lines(colMeans(mat1_HMM_50_40[,72+(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,72+(1:72)]), type='l', col="red")
mtext("Posterior means", outer=TRUE, cex=1)
legend(60,6000,c("10,5","50,40","100,70"))
legend(60,1500,c("10,5","50,40","100,70"))
legend(60,4500,c("10,5","50,40","100,70"))
legend(60,1500,c("10,5","50,40","100,70"))
legend(60,2500,c("10,5","50,40","100,70"))
legend(65,2500,c("10,5","50,40","100,70"))
legend(65,2750,c("10,5","50,40","100,70"))
legend(67,2750,c("10,5","50,40","100,70"))
legend(67,2750,legend = c("10,5","50,40","100,70"), lty=1)
legend(67,2750,legend = c("10,5","50,40","100,70"), lty=1,
col=("black","blue","red"))
legend(67,2750,legend = c("10,5","50,40","100,70"), lty=1,
col=("blue","red"))
legend(67,2750,legend = c("10,5","50,40","100,70"), lty=1,
col=("blue"))
legend(67,2750,legend = c("10,5","50,40","100,70"), lty=1, col=("blue","red","black"))
par(mfrow=c(2,1),oma=c(0,0,1.5,0))
plot(colMeans(mat1_HMM_10_5[,(1:72)]), type='l', xlab ="", ylab="", sub="X2")
lines(colMeans(mat1_HMM_50_40[,(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,(1:72)]), type='l', col="red")
plot(colMeans(mat1_HMM_10_5[,72+(1:72)]), type='l', xlab ="", ylab="", sub="X4")
lines(colMeans(mat1_HMM_50_40[,72+(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,72+(1:72)]), type='l', col="red")
mtext("Posterior means", outer=TRUE, cex=1)
legend(67,2750,legend = c("10,5","50,40","100,70"), lty=1, col=c("black","blue","red"))
par(mfrow=c(2,1),oma=c(0,0,1.5,0))
plot(colMeans(mat1_HMM_10_5[,(1:72)]), type='l', xlab ="", ylab="", sub="X2")
lines(colMeans(mat1_HMM_50_40[,(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,(1:72)]), type='l', col="red")
plot(colMeans(mat1_HMM_10_5[,72+(1:72)]), type='l', xlab ="", ylab="", sub="X4")
lines(colMeans(mat1_HMM_50_40[,72+(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,72+(1:72)]), type='l', col="red")
mtext("Posterior means", outer=TRUE, cex=1)
legend(65,2750,legend = c("10,5","50,40","100,70"), lty=1, col=c("black","blue","red"))
par(mfrow=c(3,4))
for (i in c(1:4,7:10,5,6,11,12)){
plot(mat1_HMM_10_5[,2*72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[2*72+i])
lines(mat1_HMM_50_40[,2*72+i], type="l",  ol="blue")
lines(mat1_HMM_100_70[,2*72+i], type="l", col="red")
}
par(mfrow=c(3,4))
for (i in c(1:4,7:10,5,6,11,12)){
plot(mat1_HMM_10_5[,2*72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[2*72+i])
lines(mat1_HMM_50_40[,2*72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,2*72+i], type="l", col="red")
}
load("C:/Users/aga/Dropbox/Research Visit/Ruth King/Codes/Heron/Adaptive/Heron_HMM_approx_iter30000_ada1000_linux_COMB_unifprior_norm.RData")
library(coda)
mat1_HMM_10_5 = as.matrix(output_10_5[1])
mat2_HMM_10_5 = as.matrix(output_10_5[2])
mat_names_HMM_adapt <- colnames(mat1_HMM_10_5)
mat1_HMM_50_40 = as.matrix(output_50_40[1])
mat2_HMM_50_40 = as.matrix(output_50_40[2])
mat1_HMM_100_70 = as.matrix(output_100_70[1])
mat2_HMM_100_70 = as.matrix(output_100_70[2])
par(mfrow=c(3,4))
for (i in c(1:4,7:10,5,6,11,12)){
plot(mat1_HMM_10_5[,2*72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[2*72+i])
lines(mat1_HMM_50_40[,2*72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,2*72+i], type="l", col="red")
}
par(mfrow=c(3,4))
for (i in c(1:4,7:10,5,6,11,12)){
plot(mat1_HMM_10_5[,2*72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[2*72+i])
lines(mat1_HMM_50_40[,2*72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,2*72+i], type="l", col="red")
}
par(mfrow=c(3,4))
for (i in c(1:4,7:10,5,6,11,12)){
plot(mat1_HMM_10_5[,2*72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[2*72+i])
lines(mat1_HMM_50_40[,2*72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,2*72+i], type="l", col="red")
}
par(mfrow=c(2,1),oma=c(0,0,1.5,0))
plot(colMeans(mat1_HMM_10_5[,(1:72)]), type='l', xlab ="", ylab="", sub="X2")
lines(colMeans(mat1_HMM_50_40[,(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,(1:72)]), type='l', col="red")
plot(colMeans(mat1_HMM_10_5[,72+(1:72)]), type='l', xlab ="", ylab="", sub="X4")
lines(colMeans(mat1_HMM_50_40[,72+(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,72+(1:72)]), type='l', col="red")
mtext("Posterior means", outer=TRUE, cex=1)
legend(65,2750,legend = c("10,5","50,40","100,70"), lty=1, col=c("black","blue","red"))
par(mfrow=c(2,1),oma=c(0,0,1.5,0))
plot(colMeans(mat1_HMM_10_5[,(1:72)]), type='l', xlab ="", ylab="", sub="X2")
lines(colMeans(mat1_HMM_50_40[,(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,(1:72)]), type='l', col="red")
plot(colMeans(mat1_HMM_10_5[,72+(1:72)]), type='l', xlab ="", ylab="", sub="X4")
lines(colMeans(mat1_HMM_50_40[,72+(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,72+(1:72)]), type='l', col="red")
mtext("Posterior means", outer=TRUE, cex=1)
# legend(65,2750,legend = c("10,5","50,40","100,70"), lty=1, col=c("black","blue","red"))
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
plotname = "Figures/heron_HMMnorm_trace_X2.png"
png(filename = plotname,width = 1121, height = 797, units = "px",
pointsize = 16, antialias = "cleartype")
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
dev.off()
plotname = "Figures/heron_HMMnorm_trace_X2.png"
png(filename = plotname,width = 1121, height = 797, units = "px",
pointsize = 16, antialias = "cleartype")
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
dev.off()
plotname = "Figures/heron_HMMnorm_trace_X2.png"
png(filename = plotname,width = 1121, height = 797, units = "px",
pointsize = 16, antialias = "cleartype")
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
dev.off()
# X2
plotname = "Figures/heron_HMMnorm_trace_X2.png"
png(filename = plotname,width = 1121, height = 797, units = "px",
pointsize = 16, antialias = "cleartype")
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
setwd("Heron")
# rm(list=ls())
library(rjags)
# X2
plotname = "Figures/heron_HMMnorm_trace_X2.png"
png(filename = plotname,width = 1121, height = 797, units = "px",
pointsize = 16, antialias = "cleartype")
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
dev.off()
plotname = "Figures/heron_HMMnorm_trace_X4.png"
png(filename = plotname,width = 1121, height = 797, units = "px",
pointsize = 16, antialias = "cleartype")
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,2*72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[2*72+i])
lines(mat1_HMM_50_40[,2*72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,2*72+i], type="l", col="red")
}
dev.off()
plotname = "Figures/heron_HMMnorm_trace_X4.png"
png(filename = plotname,width = 1121, height = 797, units = "px",
pointsize = 16, antialias = "cleartype")
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,2*72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[2*72+i])
lines(mat1_HMM_50_40[,2*72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,2*72+i], type="l", col="red")
}
# X4
plotname = "Figures/heron_HMMnorm_trace_X4.png"
png(filename = plotname,width = 1121, height = 797, units = "px",
pointsize = 16, antialias = "cleartype")
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[72+i])
lines(mat1_HMM_50_40[,72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,72+i], type="l", col="red")
}
dev.off()
# X2
plotname = "Figures/heron_HMMnorm_trace_X2.png"
png(filename = plotname,width = 1121, height = 797, units = "px",
pointsize = 16, antialias = "cleartype")
par(mfrow=c(3,4))
for (i in seq(1,72,6)){
plot(mat1_HMM_10_5[,i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[i])
lines(mat1_HMM_50_40[,i], type="l", col="blue")
lines(mat1_HMM_100_70[,i], type="l", col="red")
}
dev.off()
plotname = "Figures/heron_HMMnorm_mean_X.png"
png(filename = plotname,width = 1121, height = 797, units = "px",
pointsize = 16, antialias = "cleartype")
par(mfrow=c(2,1),oma=c(0,0,1.5,0))
plot(colMeans(mat1_HMM_10_5[,(1:72)]), type='l', xlab ="", ylab="", sub="X2")
lines(colMeans(mat1_HMM_50_40[,(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,(1:72)]), type='l', col="red")
plot(colMeans(mat1_HMM_10_5[,72+(1:72)]), type='l', xlab ="", ylab="", sub="X4")
lines(colMeans(mat1_HMM_50_40[,72+(1:72)]), type='l', col="blue")
lines(colMeans(mat1_HMM_100_70[,72+(1:72)]), type='l', col="red")
mtext("Posterior means", outer=TRUE, cex=1)
legend(65,2750,legend = c("10,5","50,40","100,70"), lty=1, col=c("black","blue","red"))
dev.off()
plotname = "Figures/heron_HMMnorm_trace_param.png"
png(filename = plotname,width = 1121, height = 797, units = "px",
pointsize = 16, antialias = "cleartype")
par(mfrow=c(3,4))
for (i in c(1:4,7:10,5,6,11,12)){
plot(mat1_HMM_10_5[,2*72+i], type="l", xlab = "", ylab="", sub = mat_names_HMM_adapt[2*72+i])
lines(mat1_HMM_50_40[,2*72+i], type="l", col="blue")
lines(mat1_HMM_100_70[,2*72+i], type="l", col="red")
}
dev.off()
load("C:/Users/aga/Dropbox/Research Visit/Ruth King/Codes/Heron/Results/Heron_DA_iter30000_ada1000_linux.RData")
load("C:/Users/aga/Dropbox/Research Visit/Ruth King/Codes/Heron/Results/Heron_DA_iter30000_ada1000_linux.RData")
## PRINT TIME ########################################
time_all = matrix(c(time_init_DA[3],time_init_HMM_10_5[3],time_init_HMM_50_40[3],time_init_HMM_100_70[3],
time_sample_DA[3],time_sample_HMM_10_5[3],time_sample_HMM_50_40[3],time_sample_HMM_100_70[3]),
byrow=FALSE,ncol= 2)
rownames(time_all) = c("DA","Q1=10, Q3=5","Q1=50, Q3=40","Q1=100, Q3=70")
colnames(time_all) = c("Init","Sample")
myFile <- "time_all.txt"
write.table(round(time_all, 3), file=myFile, row.names=TRUE, col.names=TRUE)
ESS_10_5 = lapply(output_10_5,effectiveSize)
ESS_50_40 = lapply(output_50_40,effectiveSize)
ESS_100_70 = lapply(output_100_70,effectiveSize)
ESS_HMM <- matrix(unlist(ESS_10_5), ncol = 1, byrow = TRUE)
View(ESS_HMM)
View(ESS_HMM)
ESS_HMM <- matrix(unlist(ESS_10_5), ncol = 2, byrow = FALSE)
View(ESS_HMM)
colnames(ESS_HMM) <- c("Q1=10, Q3=5","Q1=10, Q3=5",
"Q1=50, Q3=40","Q1=50, Q3=40",
"Q1=100, Q3=70","Q1=100, Q3=70")
rownames(ESS_HMM) <- mat_names_HMM_adapt
ESS_HMM <- matrix(unlist(ESS_10_5), ncol = 2, byrow = FALSE)
ESS_HMM <- cbind(ESS_HMM, matrix(unlist(ESS_50_40), ncol = 2, byrow = FALSE))
ESS_HMM <- cbind(ESS_HMM, matrix(unlist(ESS_100_70), ncol = 2, byrow = FALSE))
colnames(ESS_HMM) <- c("Q1=10, Q3=5","Q1=10, Q3=5",
"Q1=50, Q3=40","Q1=50, Q3=40",
"Q1=100, Q3=70","Q1=100, Q3=70")
rownames(ESS_HMM) <- mat_names_HMM_adapt
ESS_persec_HMM <- ESS_HMM/c(time_sample_HMM_10_5[3],time_sample_HMM_10_5[3],
time_sample_HMM_50_40[3],time_sample_HMM_50_40[3],
time_sample_HMM_100_70[3],time_sample_HMM_100_70[3])
save(ESS_HMM, ESS_persec_HMM,
file = paste("Results/Heron_HMMnorm_ESS.RData",sep=""))
View(ESS_HMM)
ESS_HMM_X2 = ESS_HMM[1:72,]_
ESS_HMM_X2 = ESS_HMM[1:72,]
ESS_HMM_42 = ESS_HMM[73:144,]
ESS_HMM_X2 = ESS_HMM[145:156,]
rm(ESS_HMM_42)
ESS_HMM_X2 = ESS_HMM[1:72,]
ESS_HMM_X4 = ESS_HMM[73:144,]
ESS_HMM_param = ESS_HMM[145:156,]
ESS_persec_HMM_X2 = ESS_persec_HMM[1:72,]
ESS_persec_HMM_X4 = ESS_persec_HMM[73:144,]
ESS_persec_HMM_param = ESS_persec_HMM[145:156,]
save(ESS_HMM, ESS_persec_HMM,
ESS_HMM_X2, ESS_HMM_X4, ESS_HMM_param,
ESS_persec_HMM_X2, ESS_persec_HMM_X4, ESS_persec_HMM_param,
file = paste("Results/Heron_HMMnorm_ESS.RData",sep=""))
